% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ParametricSurvKM.R
\name{ParametricSurvKM}
\alias{ParametricSurvKM}
\title{Create Kaplan-Meier Curves with Overlaid Parametric Distribution Fits}
\usage{
ParametricSurvKM(
  dataset,
  distribution,
  figure_caption = "Kaplan-Meier Curves with Parametric Distribution Overlay",
  stratify_name = NULL,
  control_arm = NULL,
  time_scale = "Months",
  time_max = NULL,
  return_plots = TRUE
)
}
\arguments{
\item{dataset}{A data frame created by DataParametricSurv() function containing
survival data with columns: SUBJID, ARM, STRATIFY, SURVTIME, CNSR, EVENT}

\item{distribution}{Character string specifying which distribution to fit and overlay.
Must be one of: "exp", "weibull", "lnorm", "llogis", "gompertz", "gengamma", "gamma"}

\item{figure_caption}{Character string for figure caption. Default is
"Kaplan-Meier Curves with Parametric Distribution Overlay"}

\item{stratify_name}{Character string specifying the original stratification
variable name for panel titles. If NULL (default), uses "STRATIFY"}

\item{control_arm}{Character string specifying which ARM should be treated as control.
Control arm will be plotted in red, treatment arm in blue. If NULL (default),
uses first ARM level as control}

\item{time_scale}{Character string specifying the time scale for x-axis label.
Default is "Months". Common options: "Months", "Years", "Weeks", "Days"}

\item{time_max}{Numeric value for maximum time on x-axis. If NULL (default),
uses maximum observed survival time}

\item{return_plots}{Logical indicating whether to return plot objects.
If TRUE (default), returns list of ggplot objects. If FALSE, displays plots}
}
\value{
A list of ggsurvplot objects (one for each stratification level) or displays plots
}
\description{
This function creates Kaplan-Meier survival curves by treatment arm and overlays
fitted parametric distribution curves. Separate panels are created for each
stratification factor level, with parameter estimates displayed on each panel.
Uses survminer package for professional survival curve plotting.
}
\details{
The function performs the following operations:
\itemize{
  \item Creates Kaplan-Meier curves for each ARM using survminer::ggsurvplot()
  \item Fits specified parametric distribution using flexsurv::flexsurvreg()
  \item Overlays parametric curves as dashed lines matching ARM colors
  \item Creates separate panels for each stratification factor level
  \item Displays parameter estimates as text annotations on each panel
  \item Includes risk table with proper alignment to x-axis
}

Colors used:
\itemize{
  \item Control arm = red, Treatment arm = blue
  \item Parametric distribution lines use matching colors but with dashed line type
}
}
\examples{
\dontrun{
# Create survival dataset first
surv_data <- DataParametricSurv(
  adsl_path = "path/to/adsl.sas7bdat",
  adtte_path = "path/to/adtte.sas7bdat",
  population = "ITTFL",
  variable = "OS",
  stratify_by = "SEX"
)

# Create KM plots with Weibull overlay, Placebo as control, custom time scale
plots_weibull <- ParametricSurvKM(
  dataset = surv_data,
  distribution = "weibull",
  figure_caption = "Overall Survival Analysis",
  stratify_name = "SEX",
  control_arm = "Placebo",
  time_scale = "Years"
)

# Display plots
print(plots_weibull)

# Create plots with exponential overlay and custom time scale
plots_exp <- ParametricSurvKM(
  dataset = surv_data,
  distribution = "exp",
  figure_caption = "Exponential Model Fit",
  stratify_name = "SEX",
  time_scale = "Weeks",
  time_max = 100
)

# Save individual plots
ggsave("OS_SEX_M_weibull.png", plots_weibull[[1]]$plot, width = 12, height = 8)
ggsave("OS_SEX_F_weibull.png", plots_weibull[[2]]$plot, width = 12, height = 8)
}
}
